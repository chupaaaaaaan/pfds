# Exercise 6.2

snoc と tail がそれぞれ $1$、$3$ の負債を返済することで、次の負債不変条件を満たし、$O(1)$ の償却上限が成り立つことを証明する。

$D(i) \leq \min(3i, 2|f| - |r|)$

## 回転の起こらない snoc

|r| を $1$ 増やし $2|f| - |r|$ が $1$ 減る。
最初のノードの負債を $1$ 減らすことで負債不変条件を維持できる。

## 回転の起こらない tail

|f| を $1$ 減らし $2|f| - |r|$ が $2$ 減る。
また、すべてのノードのインデックスを $1$ 減らすので、$3i$ が $3$ 減る。
したがって $3$ の負債を返済することで負債不変条件を維持できる。

## 回転の起こる snoc と tail

回転の際に $|f| = m, |r| = 2m + 1$ だったとする。各ノードの負債は、以下のようにおける。

$d(i) = 1 (i < m), d(i) = 2m + 1 (i = m), d(i) = 0 (i > m)$、

$D(i) = i + 1 (i < m), D(i) = 3m + 1 (i \geq m)$

これは $i = 0, m$ のノードで不変条件に違反するが、$i = 0$ の負債を返済すれば、両方のノードで不変条件を維持できる。
